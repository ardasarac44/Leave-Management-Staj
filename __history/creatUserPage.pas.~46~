unit creatUserPage;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, dbConnection, professorClass;

type
  Tcreate_new_user = class(TForm)
    firstNameLabel: TLabel;
    lastNameLabel: TLabel;
    facultyLabel: TLabel;
    departmentLabel: TLabel;
    emailLabel: TLabel;
    firstNameBox: TEdit;
    lastNameBox: TEdit;
    facultyBox: TEdit;
    departmentBox: TEdit;
    emailBox: TEdit;
    Button1: TButton;
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  create_new_user: Tcreate_new_user;

implementation

{$R *.dfm}





procedure Tcreate_new_user.Button1Click(Sender: TObject);
var
  lsqlQuery: string;
  lnewProfId: integer;
  begin
    dbConnection.dbForm.getNumberOfUsersQ.Execute;

    lnewProfId :=  dbConnection.dbForm.getNumberOfUsersQ.Field('Count(*)');
    try
      with dbConnection.dbForm.insertUserQ do
        begin
           SetVariable('prof_id', lnewProfId+1);
           SetVariable('firstname', firstNameBox.Text);
           SetVariable('lastname', lastNameBox.Text);
           SetVariable('faculty', facultyBox.Text);
           SetVariable('department', departmentBox.Text);
           SetVariable('email', emailBox.Text);
           Execute;
        end;

      except
    end;
    create_new_user.Close;
  end;


end.
